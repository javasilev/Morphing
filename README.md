Тестовое приложение «Морфинг».
 
Тестовое приложение представляет собой простое приложение, работающее только в одной (портретной) ориентации и состоящее из трех последовательно появляющихся экранов, соответствующих одной из стадий работы приложения. Возврат к предыдущей стадии работы осуществляет с помощью кнопки «Назад».

Суть приложения: необходимо создать анимацию морфинга одного изображения в другое (перетекание одного лица в другое путем изменения прозрачности второго парного изображения).

Стадия 1. Выбор изображений партнеров для морфинга.
При запуске приложения появляется окно с четырьмя квадратными изображениями – фотографиями лиц людей. Отдельно выделяется основная фотография (основа морфинга) и рядом 3 изображения-партнера (одно из них выбирается в качестве второго изображения).
В качестве тестовых изображений могут быть взяты любые изображения лиц квадратного размера (желательно, чтобы расстояние между глазами на фотографиях было более-менее равным, в этом случае результирующая анимация будет более «гладкой»).
На этом экране должна быть возможность выбора изображения-партнера (т.е. изображения, в которое будет «перетекать» основное изображение). При выборе изображение-партнер должно визуально маркироваться (например галочкой). Выбрать можно только одно изображение из трех.
После того как изображение выбрано становится активной кнопка перехода ко второй стадии.

Стадия 2. Настройка параметров морфинга.
В новом окне должны располагаться элементы:
- зона изображения: представляет собой два изображения одинакового размера, наложенные друг на друга. Нижнее изображение является основной фотографией. Поверх него с изначальной прозрачностью в 0% наложено изображение-партнер.
- слайдер: диапазон значений от 0 до 100, представляет собой настройку прозрачности верхнего изображения. При изменении значения меняется прозрачность верхнего изображения партнера. По умолчанию значение 0. Необходим для установки максимального значения непрозрачности изображения-партнера при генерации анимации морфинга.
- дополнительные настроечные поля. Необходимы 2 числовых настроечных поля. Первое поле - количество кадров в секунду (диапазон значений целочисленный от 1 до 15, значение по умолчанию – 6), второе поле – длительность анимации в секундах (вещественное число, с визуальным округлением введенного значения до десятых, диапазон от 0.5 до 6.0, значение по умолчанию – 2.0).
- кнопка перехода к финальной стадии.

Стадия 3. Показ сгенерированной анимации и ее экспорт.
На последнем экране находятся 2 элемента: зона вывода анимации и кнопка сохранения файла.
В зоне вывода анимации мы делаем превью анимации по настройкам, выставленным на предыдущем экране. С учетом выбранного количества кадров секунду, длительности анимации и значения слайдера непрозрачности мы генерируем последовательность изображений, на которой постепенно одно изображение (основное) постепенно перекрывается вторым (изображением-партнером). В процессе у второго изображения меняется прозрачность от 0 до значения на слайдере. Шаг изменения рассчитывается по общему количеству кадров и может быть вещественным числом. Результат выводим в зоне просмотра, зацикливая анимацию при ее окончании.
Кнопка «Сохранить», используя библиотеку генерации gif-изображений, экспортирует сгенерированную последовательность в незацикленный (воспроизводится 1 раз) анимированный gif-файл (количество кадров и длительность анимации берем из настроек) и позволяет сохранить его в указанное пользователем место.
В случае если в gif-изображении в процессе генерации появились кадры-дубли (т.е. изображения генерировались с разницей в прозрачности менее 0.5%), их необходимо убрать, увеличив длительность показа оригинального изображения в столько раз, сколько дублей было убрано (например если одинаковых изображений было 3 и 2 убрали, показываем оставшееся изображение в 3 раза дольше). Т.к. анимация у нас линейна, то поиск дублей необходимо будет провести лишь 1 раз и увеличить время также только 1 раз для всех кадров.
